# **************************************************
# Copyright (c) 2025, Mayank Mishra
# **************************************************

cloud: gcp
spin-up: false

node:
  name: node-1
  project: camp-blue-431854084
  zone: asia-northeast1-b
  accelerator: v6e-1
  version: v2-alpha-tpuv6e
  disk: mayank-fs
  spot: false

installation:
  # install uv
  - curl -LsSf https://astral.sh/uv/install.sh | sh
  # clone the repo
  # - rm -rf lm-engine
  # - git clone https://github.com/open-lm-engine/lm-engine
  - cd lm-engine
  - git pull
  # - git submodule update --init --recursive
  # - git checkout tpu
  - source $HOME/.local/bin/env
  - uv sync --extra tpu
  - uv run --extra tpu sh scripts/gcp-tpu/pretrain.sh configs/pretraining-examples/dense/pretrain-tpu.yml |& tee err.log
